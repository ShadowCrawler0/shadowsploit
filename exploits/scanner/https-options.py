import argparse
import requests

parser = argparse.ArgumentParser(description='HTTP Method Scanner')
parser.add_argument('--rhost', help='Target host', required=True)
args = parser.parse_args()

def scan_methods(host):
    url = f"https://{host}"
    methods = ['GET', 'PUT', 'DELETE', 'POST', 'HEAD', 'PATCH', 'TRACE', 'CONNECT', 'OPTIONS']

    for method in methods:
        try:
            response = requests.request(method, url)
            if response.status_code == 200:
                print(f"[+] {method} request successful for {url}")
            else:
                print(f"[-] {method} request failed for {url}")
        except requests.exceptions.RequestException as e:
            print(f"[-] Error occurred during {method} request: {e}")

if __name__ == '__main__':
    scan_methods(args.rhost)
