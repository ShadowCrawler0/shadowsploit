import requests
from bs4 import BeautifulSoup

# Common CSRF token field name patterns
COMMON_CSRF_NAMES = ['csrf', 'token', '_csrf', 'csrf_token', '__requestverificationtoken', 'authenticity_token']

def detect_csrf_token(url):
    try:
        print(f"[+] Fetching form from: {url}")
        response = requests.get(url, timeout=10, verify=False)
        soup = BeautifulSoup(response.text, "html.parser")

        forms = soup.find_all("form")
        if not forms:
            print("[-] No forms found on the page.")
            return

        found = False
        for i, form in enumerate(forms):
            print(f"\n[+] Analyzing form #{i + 1}")
            inputs = form.find_all("input")

            for inp in inputs:
                name = inp.get("name", "").lower()
                input_type = inp.get("type", "").lower()
                value = inp.get("value", "")

                if input_type == "hidden" and any(csrf_name in name for csrf_name in COMMON_CSRF_NAMES):
                    print(f"[âœ”] CSRF Token Found:")
                    print(f"     Name : {name}")
                    print(f"     Value: {value}")
                    found = True

        if not found:
            print("[-] No CSRF token detected in hidden input fields.")

    except Exception as e:
        print(f"[!] Error: {e}")

if __name__ == "__main__":
    target_url = input("Enter the target form URL: ").strip()
    detect_csrf_token(target_url)
