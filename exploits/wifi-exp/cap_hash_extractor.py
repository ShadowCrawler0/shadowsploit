import subprocess
import os

def extract_hash(cap_file, output_file):
    if not os.path.exists(cap_file):
        print("[x] Capture file not found.")
        return

    print(f"[*] Trying to extract hash from {cap_file}...")
    cmd = ["hcxpcapngtool", "-o", output_file, cap_file]
    try:
        subprocess.run(cmd, check=True)
        print(f"[âœ”] Hash saved to {output_file}")
    except FileNotFoundError:
        print("[!] hcxpcapngtool not found. Install it using:")
        print("    sudo apt install hcxtools")
    except subprocess.CalledProcessError:
        print("[x] Error extracting hash.")

if __name__ == "__main__":
    cap = input("Enter .cap or .pcap file: ").strip()
    output = input("Output hash file (e.g., hash.16800): ").strip()
    extract_hash(cap, output)
