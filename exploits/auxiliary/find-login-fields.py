import requests
from bs4 import BeautifulSoup

def find_login_fields(url):
    print(f"Fetching login page: {url}")
    response = requests.get(url)
    response.raise_for_status()

    soup = BeautifulSoup(response.text, 'html.parser')

    # Find all forms
    forms = soup.find_all('form')
    if not forms:
        print("No forms found on the page.")
        return

    # For simplicity, analyze the first form
    form = forms[0]
    print(f"Analyzing form with action: {form.get('action')}")

    inputs = form.find_all('input')

    username_field = None
    password_field = None
    submit_field = None

    for inp in inputs:
        input_type = inp.get('type', '').lower()
        input_name = inp.get('name')
        input_id = inp.get('id', '')
        input_placeholder = inp.get('placeholder', '').lower()

        # Heuristics for username field
        if input_type in ['text', 'email']:
            if any(keyword in (input_name or '').lower() for keyword in ['user', 'email', 'login']) or \
               any(keyword in input_id.lower() for keyword in ['user', 'email', 'login']) or \
               'user' in input_placeholder or 'email' in input_placeholder:
                username_field = input_name or input_id

        # Heuristics for password field
        if input_type == 'password':
            password_field = input_name or input_id

        # Heuristics for submit button
        if input_type in ['submit', 'button']:
            submit_field = input_name or input_id or inp.get('value')

    print("Detected form fields:")
    print(f"  Username field: {username_field}")
    print(f"  Password field: {password_field}")
    print(f"  Submit field: {submit_field}")

    # Also print hidden inputs (e.g., CSRF tokens)
    hidden_inputs = [inp for inp in inputs if inp.get('type', '').lower() == 'hidden']
    if hidden_inputs:
        print("\nHidden fields (may be needed for login):")
        for hidden in hidden_inputs:
            print(f"  {hidden.get('name')} = {hidden.get('value')}")

if __name__ == "__main__":
    url = input("Enter the login page URL: ").strip()
    find_login_fields(url)
