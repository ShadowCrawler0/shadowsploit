import socket
import requests

def mssql_ping_scan(host, port):
    try:
        # Attempt to connect to the MSSQL server using a TCP socket
        sock = socket.socket(socket.AF_INET, socket.SOCK_STREAM)
        sock.settimeout(20)
        sock.connect((host, port))
        sock.close()

        # Send a simple HTTP request to the MSSQL server
        url = f'https://{host}:{port}/'
        response = requests.get(url)

        # Check if the response contains the expected MSSQL version string
        if 'Microsoft SQL Server' in response.text:
            print(f'[+] MSSQL version: {response.text}')
            return True
        else:
            print('[-] Failed to retrieve MSSQL version')
            return False
    except socket.error as e:
        print(f'[-] Error: {e}')
        return False
    except requests.exceptions.RequestException as e:
        print(f'[-] Error: {e}')
        return False

# Usage example
host = input("URL (example: example.com): ")
port = 1433
mssql_ping_scan(host, port)
