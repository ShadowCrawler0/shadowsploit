from pysmb import smb

def audit_pipes(server, share):
    conn = smb.SMBConnection(server, server, share=share)
    conn.connect()

    named_pipes = conn.listPath('\\\\pipe\\', '*')

    print("Auditing named pipes on:")
    print(f"Server: {server}")
    print(f"Share: {share}")
    for pipe in named_pipes:
        print(pipe.name)

    conn.close()

if __name__ == '__main__':
    server = input("Enter the server IP address: ")
    share = input("Enter the share name: ")

    audit_pipes(server, share)
