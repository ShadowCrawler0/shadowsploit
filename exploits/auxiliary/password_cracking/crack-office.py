import zipfile
import argparse
from tqdm import tqdm

def crack_office(file_path, password_file):
    """
    Crack an Office document using a password list.

    Args:
        file_path (str): The path to the Office document file.
        password_file (str): The path to the file containing passwords.

    Returns:
        bool: True if the password is found, False otherwise.
    """
    with open(password_file, 'r') as file:
        passwords = file.readlines()

    with zipfile.ZipFile(file_path) as zip_file:
        for password in tqdm(passwords, desc="Cracking Office document"):
            password = password.strip()
            try:
                zip_file.extractall(pwd=password.encode())
                print(f"Password found: {password}")
                return True
            except:
                pass

    print("Password not found.")
    return False

if __name__ == "__main__":
    parser = argparse.ArgumentParser(description="Crack Office documents using a password list.")
    parser.add_argument('file_path', help="The path to the Office document file.")
    parser.add_argument('password_file', help="The path to the file containing passwords.")
    args = parser.parse_args()

    crack_office(args.file_path, args.password_file)
